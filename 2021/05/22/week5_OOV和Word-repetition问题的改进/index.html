<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"marchboy.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Out of Vocabularywhy&amp;what is OOV未登录词就是训练时未出现，测试时出现了的单词。在自然语言处理或者文本处理的时候，我们通常会有一个字词库（vocabulary）。这个vocabulary要么是提前加载的，或者是自己定义的，或者是从当前数据集提取的。假设之后你有了另一个的数据集，这个数据集中有一些词并不在你现有的vocabulary里，我们就说这些词汇是Out-">
<meta property="og:type" content="article">
<meta property="og:title" content="week5_OOV和Word-repetition问题的改进">
<meta property="og:url" content="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/index.html">
<meta property="og:site_name" content="ComputerScience">
<meta property="og:description" content="Out of Vocabularywhy&amp;what is OOV未登录词就是训练时未出现，测试时出现了的单词。在自然语言处理或者文本处理的时候，我们通常会有一个字词库（vocabulary）。这个vocabulary要么是提前加载的，或者是自己定义的，或者是从当前数据集提取的。假设之后你有了另一个的数据集，这个数据集中有一些词并不在你现有的vocabulary里，我们就说这些词汇是Out-">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/Baseline_Seq2Seq.png">
<meta property="og:image" content="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/pointer-generationer-structure.png">
<meta property="og:image" content="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/CoverageMechanism.png">
<meta property="og:image" content="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/word_repetion.png">
<meta property="article:published_time" content="2021-05-21T16:00:00.000Z">
<meta property="article:modified_time" content="2021-05-24T13:31:37.764Z">
<meta property="article:author" content="进军要努力呀">
<meta property="article:tag" content="NLP">
<meta property="article:tag" content="摘要自动生成">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/Baseline_Seq2Seq.png">

<link rel="canonical" href="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>week5_OOV和Word-repetition问题的改进 | ComputerScience</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74793810-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-74793810-1');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a5f7448ac0b523badc121b2d870f1b0c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ComputerScience</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">温故而知新</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="进军要努力呀">
      <meta itemprop="description" content="可怕的是自己内心的堕落">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ComputerScience">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          week5_OOV和Word-repetition问题的改进
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-22 00:00:00" itemprop="dateCreated datePublished" datetime="2021-05-22T00:00:00+08:00">2021-05-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-24 21:31:37" itemprop="dateModified" datetime="2021-05-24T21:31:37+08:00">2021-05-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%91%98%E8%A6%81%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90/" itemprop="url" rel="index"><span itemprop="name">摘要自动生成</span></a>
                </span>
            </span>

          
            <span id="/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/" class="post-meta-item leancloud_visitors" data-flag-title="week5_OOV和Word-repetition问题的改进" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>5 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="Out-of-Vocabulary"><a href="#Out-of-Vocabulary" class="headerlink" title="Out of Vocabulary"></a>Out of Vocabulary</h3><h4 id="why-amp-what-is-OOV"><a href="#why-amp-what-is-OOV" class="headerlink" title="why&amp;what is OOV"></a>why&amp;what is OOV</h4><p>未登录词就是训练时未出现，测试时出现了的单词。在自然语言处理或者文本处理的时候，我们通常会有一个字词库（vocabulary）。这个vocabulary要么是提前加载的，或者是自己定义的，或者是从当前数据集提取的。假设之后你有了另一个的数据集，这个数据集中有一些词并不在你现有的vocabulary里，我们就说这些词汇是Out-of-vocabulary，简称OOV。</p>
<p>For example, words such as “tensor” and “tensor” are present in the vocabulary of Word2Vec. But if you try to get embedding for the compound word “tensorflow”, you will get an out of vocabulary error.</p>
<ul>
<li>Typo（排版错误，文本里面存在错别字造成的oov）</li>
<li>Different Vocabularies（不同的词汇表，词不在你来做训练的语料库中、新词的产生并没有添加到你训练的语料库中）</li>
<li>new words are being created every second（每时每刻都在产生新的词汇）</li>
<li>you cannot afford to annotate too many data（不能注解太多的词汇）</li>
</ul>
<h4 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h4><ul>
<li><p>Spell check（过滤掉错误的单词）</p>
</li>
<li><p>Ignore（忽略，这种方法不常用）</p>
</li>
<li><p>UNK work（变成默认词（UNK work，可以在一定程度上缓解oov的问题，但是很多重要的词这样做后都会变成默认词，不太合适 ）</p>
<p>This solution is to reserve a dimension in feature space, it may eliminate some impact of OOV word, but very limited. Especially the OOV word plays an important role in the NLP task, e.g. some positive and negative words are OOV words in sentiment analysis.</p>
<p>这种解决方案是在特征空间中保留一个维度，它可能会消除OOV词的一些影响，但非常有限。特别是面向对象词在自然语言处理中起着重要的作用，如一些积极词和消极词在情感分析中都属于面向对象词。</p>
</li>
<li><p>Enlarge Vocabulary（速度下降，会造成数据分布不均）</p>
</li>
<li><p>Individual Characters（把单词切开，将词转换成字符（将每个token变换成字符进行切割，再根据字符拼接，这样会丢失句法和语义信息）</p>
</li>
<li><p>subword（介于token和character方法，对词频低的词不太友好）</p>
</li>
<li><p>Byte Pair Encoding：BPE（根据词频确定留哪些subword）</p>
</li>
<li><p>word piece </p>
</li>
<li><p>unigram language model(看下ppt中的步骤)。 </p>
</li>
<li><p>PGN网络（重点难点，参考一下 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/monkeyT/p/12337556.html%EF%BC%89">https://www.cnblogs.com/monkeyT/p/12337556.html）</a></p>
</li>
</ul>
<h3 id="Subword"><a href="#Subword" class="headerlink" title="Subword"></a>Subword</h3><h4 id="sub-word-generation"><a href="#sub-word-generation" class="headerlink" title="sub-word generation"></a>sub-word generation</h4><p>For a word, we generate character n-grams of length FROM n to m(n&lt;m)  present in it.</p>
<p>因为可能有大量唯一的n-gram，所以我们应用哈希来限制内存需求。每个字符n-gram被哈希为1到B之间的整数。</p>
<h4 id="Byte-Pair-Encoding-BPE"><a href="#Byte-Pair-Encoding-BPE" class="headerlink" title="Byte Pair Encoding(BPE)"></a>Byte Pair Encoding(BPE)</h4><p>1、准备⾜够大的训练语料<br>2、确定期望的subword词表大小<br>3、将单词拆分为字符序列并在末尾添加后缀“ &lt;/ w&gt;”，统计单词频率。 本阶段的subword的粒度是字符。 例如，“ low”的频率为5，那么我们将其改写为“ l o w &lt;/ w&gt;”：5<br>4、统计每⼀个连续字节对的出现频率，选择最⾼频者合并成新的subword<br>5、重复第4步直到达到第2步设定的subword词表大小或下⼀个最⾼频的字节对出现频率为1</p>
<h4 id="WordPiece"><a href="#WordPiece" class="headerlink" title="WordPiece"></a>WordPiece</h4><p>1、准备⾜够大的训练语料<br>2、确定期望的subword词表大小<br>3、将单词拆分成字符序列<br>4、基于第3步数据训练语⾔模型<br>5、从所有可能的subword单元中选择加⼊语⾔模型后能最⼤程度地增加训练数据概率的单元作为新的单元<br>6、重复第5步直到达到第2步设定的subword词表⼤⼩或概率增量低于某⼀阈值</p>
<p><a target="_blank" rel="noopener" href="https://huggingface.co/transformers/_modules/transformers/tokenization_bert.html#BertTokenizer">https://huggingface.co/transformers/_modules/transformers/tokenization_bert.html#BertTokenizer</a></p>
<h4 id="Unigram-Language-Model"><a href="#Unigram-Language-Model" class="headerlink" title="Unigram Language Model"></a>Unigram Language Model</h4><p>1、准备⾜够⼤的训练语料<br>2、确定期望的subword词表⼤⼩<br>3、给定词序列优化下⼀个词出现的概率<br>4、计算每个subword的损失<br>5、基于损失对subword排序并保留前X%。为了避免OOV<br>6、重复第3⾄第5步直到达到第2步设定的subword词表⼤⼩或第5步的结果不再变化</p>
<h3 id="Pointer-Generator-Network"><a href="#Pointer-Generator-Network" class="headerlink" title="Pointer-Generator Network"></a>Pointer-Generator Network</h3><p>文本摘要旨在将文本或文本集合转换为包含关键信息的简短摘要。按照输出类型可分为抽取式摘要和生成式摘要。<strong>抽取式摘要从源文档中抽取关键句和关键词组成摘要，摘要全部来源于原文</strong>。<strong>生成式摘要根据原文，允许生成新的词语、原文本中没有的短语来组成摘要。</strong></p>
<p>指针生成网络属于生成式模型。</p>
<p>仅用Neural sequence-to-sequence模型可以实现生成式摘要，但存在两个问题：<br><strong>1、 可能不准确地再现细节,</strong> <strong>无法处理词汇不足（OOV）单词;</strong><br><strong>2、</strong> <strong>倾向于重复自己</strong>。</p>
<p>原文是（they are liable to reproducefactual details inaccurately, and they tendto repeat themselves.）<br>指针生成网络（Pointer-Generator-Network）从两个方面<strong>进行了改进</strong>：</p>
<p><strong>1. 该网络通过指向（pointer）从源文本中复制单词，有助于准确地复制信息，同时保留通过生成器产生新单词的能力；</strong><br><strong>2. 使用coverage机制来跟踪已总结的内容，防止重复。</strong> </p>
<p>接下来从下面几个部分介绍Pointer-Generator-Network原理：<br>1、Baseline sequence-to-sequence;<br>2、Pointer-Generator-Network;<br>3、Coverage Mechanism。</p>
<h4 id="Baseline-sequence-to-sequence"><a href="#Baseline-sequence-to-sequence" class="headerlink" title="Baseline sequence-to-sequence"></a>Baseline sequence-to-sequence</h4><p>Pointer-Generator Networks是在Baseline sequence-to-sequence模型的基础上构建的，我们首先Baseline seq2seq+attention。其架构图如下：</p>
<p><img src="/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/Baseline_Seq2Seq.png"></p>
<p>该模型可以<strong>关注原文本中的相关单词以生成新单词</strong>进行概括。比如：模型可能<strong>注意到原文</strong>中的**”victorious”<strong>和</strong>“ win”<strong>这个两个单词，在摘要”Germany beat Argentina 2-0”中</strong>生成了新的单词beat** 。</p>
<p>Seq2Seq的模型结构是<strong>经典的Encoder-Decoder模型</strong>，即先用Encoder将原文本编码成一个中间层的隐藏状态，然后用Decoder来将该隐藏状态解码成为另一个文本。Baseline Seq2Seq在<strong>Encoder端</strong>是一个双向的LSTM，这个<strong>双向的LSTM可以捕捉原文本的长距离依赖关系以及位置信息，</strong>编码时词嵌入经过双向LSTM后得到编码状态$h_i$。在<strong>Decoder端</strong>，<strong>解码器是一个单向的LSTM</strong>，训练阶段时参考摘要词依次输入(测试阶段时是上一步的生成词)，在时间步$t$得到解码状态$s_t$。使用$h_i$和$s_t$得到该时间步原文第$i$个词注意力权重。</p>
<h4 id="Pointer-Generator-Network-1"><a href="#Pointer-Generator-Network-1" class="headerlink" title="Pointer-Generator-Network"></a>Pointer-Generator-Network</h4><p>原文中的Pointer-Generator Networks是一个混合了 Baseline seq2seq和PointerNetwork的网络，它具有Baseline seq2seq的生成能力和PointerNetwork的Copy能力。该网络的结构如下：</p>
<p><img src="/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/pointer-generationer-structure.png"></p>
<p><strong>如何权衡一个词应该是生成的还是复制的？</strong></p>
<p>　　<strong>原文中引入了一个权重$p_{gen}$ 。</strong></p>
<p>　　从Baseline seq2seq的模型结构中得到了$s_t$和$h_t^*$，和解码器输入$x_t$一起来计算$p_{gen}$：<br>$$<br>p_{gen} = \sigma(w_{h^*}^T h_t^* + w_s^Ts_t + w_x^Tx_t + b_{ptr})<br>$$<br>　　这时，会扩充单词表形成一个更大的单词表–扩充单词表(将原文当中的单词也加入到其中)，该时间步的预测词概率为：</p>
<p>$$<br>P(w) = p_{gen}P_{vocab}(w) + (1 - p_{gen}) \sum_{i:w_i=w} a_i^t<br>$$</p>
<p>　　其中 atiait 表示的是原文档中的词。我们可以看到解码器一个词的输出概率有其是否拷贝是否生成的概率和决定。<strong>当一个词不出现在常规的单词表上时$P_{vocab}(w)$ 为0，当该词不出现在文档中$\sum_{i:w_i=w} a_i^t$为0。</strong></p>
<h4 id="Coverage-mechanism"><a href="#Coverage-mechanism" class="headerlink" title="Coverage mechanism"></a>Coverage mechanism</h4><p>原文的特色是运用了Coverage Mechanism来解决重复生成文本的问题，下图反映了前两个模型与添加了Coverage Mechanism生成摘要的结果：</p>
<p><img src="/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/CoverageMechanism.png"></p>
<p>蓝色的字体表示的是参考摘要，三个模型的生成摘要的结果差别挺大<br>红色字体表明了不准确的摘要细节生成(UNK未登录词，无法解决OOV问题);<br>绿色的字体表明了模型生成了重复文本。<br>为了解决此问题–Repitition，原文使用了在机器翻译中解决“过翻译”和“漏翻译”的机制–Coverage Mechanism。</p>
<p>具体实现上，就是将先前时间步的注意力权重加到一起得到所谓的覆盖向量 ct(coveragevector)，用先前的注意力权重决策来影响当前注意力权重的决策，这样就避免在同一位置重复，从而避免重复生成文本。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/think90/p/11590469.html">指针生成网络(Pointer-Generator-Network)原理与实战</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zingp/p/11571593.html">指针生成网络(Pointer-Generator-Network)原理与实战</a></p>
<h3 id="Word-Repetition"><a href="#Word-Repetition" class="headerlink" title="Word Repetition"></a>Word Repetition</h3><p>生成式任务存在文本重复问题解决方法–Coverage(每次预测都会的到概率分布，根据概率去强迫模型关注之前没有关注的内容)。</p>
<p><img src="/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/word_repetion.png"></p>
<h3 id="Text-Summarization-在阿⾥"><a href="#Text-Summarization-在阿⾥" class="headerlink" title="Text Summarization 在阿⾥"></a>Text Summarization 在阿⾥</h3><p>[论文：Multi-Source Pointer Network for Product Title Summarization](<a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1808.06885.pdf">Multi-Source Pointer Network for Product Title Summarization (arxiv.org)</a>)</p>
<p>商品标题摘要这个特殊问题天然存在对模型的两个限制：<br>1）摘要中不能引⼊不相关信息<br>2）摘要中必须保留源⽂本的关键信息（如品牌名和商品名）</p>
<h3 id="Hyper-Parameter-Tuning"><a href="#Hyper-Parameter-Tuning" class="headerlink" title="Hyper-Parameter Tuning"></a>Hyper-Parameter Tuning</h3><h4 id="Hand-Turning"><a href="#Hand-Turning" class="headerlink" title="Hand Turning"></a>Hand Turning</h4><h5 id="Good-Coding-Style"><a href="#Good-Coding-Style" class="headerlink" title="Good Coding Style"></a>Good Coding Style</h5><ul>
<li>将各个参数的设置部分集中在⼀起。如果参数的设置分布在代码的各个地方，那么修改的过程想必会⾮常痛苦。</li>
<li>可以输出模型的损失函数值以及训练集和验证集上的准确率。</li>
<li>可以考虑设计⼀个⼦程序，可以根据给定的参数，启动训练并监控和周期性保存评估结果。再由⼀个主程序，分配参数以及并⾏启动⼀系列子程序。</li>
</ul>
<h5 id="General-to-Specific"><a href="#General-to-Specific" class="headerlink" title="General to Specific"></a>General to Specific</h5><ul>
<li>建议先参考相关论⽂，以论⽂中给出的参数作为初始参数。⾄少论⽂中的参数，是个不差的结果。</li>
<li>如果找不到参考，那么只能⾃⼰尝试了。可以先从⽐较重要，对实验结果影响⽐较⼤的参数开始，同时固定其他参数，得到⼀个差不多的结果以后，在这个结果的基础上，再调其他参数。<br>例如学习率⼀般就⽐正则值，dropout值重要的话，学习率设置的不合适，不仅结果可能变差，模型甚⾄会⽆法收敛。</li>
<li>如果实在找不到⼀组参数让模型收敛。那么就需要检查，是不是其他地⽅出了问题，例如模型实现，数据等等。</li>
</ul>
<h5 id="Speed-up-Experiment"><a href="#Speed-up-Experiment" class="headerlink" title="Speed up Experiment"></a>Speed up Experiment</h5><ul>
<li>对训练数据进⾏采样。例如原来100W条数据，先采样成1W，进⾏实验看看。</li>
<li>减少训练类别。例如⼿写数字识别任务，原来是10个类别， 那么我们可以先在2个类别上训练，看看结果如何。</li>
</ul>
<h5 id="Experiment-Number"><a href="#Experiment-Number" class="headerlink" title="Experiment Number"></a>Experiment Number</h5><ul>
<li>learning rate: 1 0.1 0.01 0.001, ⼀般从1开始尝试。很少见learning rate⼤于10的。<br>学习率⼀般要随着训练进⾏衰减。<br>衰减系数⼀般是0.5。<br>衰减时机，可以是验证集准确率不再上升时，或固定训练多少个周期以后。<br>不过更建议使⽤⾃适应梯度的办法，例如adam,adadelta,rmsprop等，这些⼀般使⽤相关论⽂提供的默认值即可，可以避免再费劲调节学习率。<br>对RNN来说，有个经验，如果RNN要处理的序列⽐较长，或者RNN层数⽐较多，那么learning rate⼀般⼩⼀些⽐较好，否则有可能出现结果不收敛，甚⾄Nan等问题。</li>
<li>⽹络层数： 先从1层开始。</li>
<li>每层结点数： 16 32 128，超过1000的情况⽐较少见。超过1W的从来没有见过。</li>
<li>batch size: 128上下开始。batch size值增加，的确能提⾼训练速度。但是有可能收敛结果变差。如果显存⼤⼩允许，可以考虑从⼀个⽐较⼤的值开始尝试。因为batch size太⼤，⼀般不会对结果有太⼤的影响，⽽batch size太⼩的话，结果有可能很差。</li>
<li>clip c(梯度裁剪): 限制最⼤梯度,其实是value = sqrt(w1^2+w2^2….),如果value超过了阈值，就算⼀个衰减系系数,让value的值等于阈值: 5,10,15</li>
<li>dropout： 0.5</li>
<li> L2正则：1.0，超过10的很少见。</li>
<li>词向量embedding⼤⼩：128，256</li>
<li>正负样本⽐例： 这个是⾮常忽视，但是在很多分类问题上，又⾮常重要的参数。很多⼈往往习惯使⽤训练数据中默认的正负类别⽐例，当训练数据⾮常不平衡的时候，模型很有可能会偏向数⽬较⼤的类别，从⽽影响最终训练结果。除了尝试训练数据默认的正负类别⽐例之外，建议对数⽬较⼩的样本做过采样，例如进⾏复制。提⾼他们的⽐例，看看效果如何，这个对多分类问题同样适⽤。在使⽤mini-batch⽅法进⾏训练的时候，尽量让⼀个batch内，各类别的⽐例平衡，这个在图像识别等多分类任务上⾮常重要。</li>
</ul>
<h5 id="HP-Range"><a href="#HP-Range" class="headerlink" title="HP Range"></a>HP Range</h5><p>建议优先在对数尺度上进⾏超参数搜索。⽐较典型的是学习率和正则化项，我们可以从诸如0.001 0.01 0.1 1 10，以10为阶数进⾏尝试。<br>因为他们对训练的影响是相乘的效果。不过有些参数，还是建议在原始尺度上进⾏搜索，例如dropout值: 0.3 0.5 0.7)。</p>
<h4 id="Auto-Turning"><a href="#Auto-Turning" class="headerlink" title="Auto Turning"></a>Auto Turning</h4><p>Tensorboard（Keras Turner）</p>
<p><a target="_blank" rel="noopener" href="https://github.com/tensorflow/adanet">Adanet</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/h2oai/h2o-3">H2O.ai</a></p>

    </div>

    
    
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;"> ------ 本文结束------</div>
    
</div>
        <div class="reward-container">
  <div>Donate comment here.</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="进军要努力呀 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="进军要努力呀 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>进军要努力呀
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://marchboy.github.io/2021/05/22/week5_OOV%E5%92%8CWord-repetition%E9%97%AE%E9%A2%98%E7%9A%84%E6%94%B9%E8%BF%9B/" title="week5_OOV和Word-repetition问题的改进">https://marchboy.github.io/2021/05/22/week5_OOV和Word-repetition问题的改进/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/NLP/" rel="tag"><i class="fa fa-tag"></i> NLP</a>
              <a href="/tags/%E6%91%98%E8%A6%81%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90/" rel="tag"><i class="fa fa-tag"></i> 摘要自动生成</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/05/16/week4_NLG%E8%BF%87%E7%A8%8B%E7%9A%84%E4%BC%98%E5%8C%96%E5%92%8C%E9%A1%B9%E7%9B%AEInference/" rel="prev" title="week4_NLG过程的优化与项目Inference">
      <i class="fa fa-chevron-left"></i> week4_NLG过程的优化与项目Inference
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/05/23/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%88%A4%E5%88%AB%E6%A8%A1%E5%9E%8B/" rel="next" title="生成式模型和判别式模型">
      生成式模型和判别式模型 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-gitalk">gitalk</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane gitalk" id="comment-gitalk">
              <div class="comments" id="gitalk-container"></div>
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Out-of-Vocabulary"><span class="nav-number">1.</span> <span class="nav-text">Out of Vocabulary</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#why-amp-what-is-OOV"><span class="nav-number">1.1.</span> <span class="nav-text">why&amp;what is OOV</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Solutions"><span class="nav-number">1.2.</span> <span class="nav-text">Solutions</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Subword"><span class="nav-number">2.</span> <span class="nav-text">Subword</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sub-word-generation"><span class="nav-number">2.1.</span> <span class="nav-text">sub-word generation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Byte-Pair-Encoding-BPE"><span class="nav-number">2.2.</span> <span class="nav-text">Byte Pair Encoding(BPE)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WordPiece"><span class="nav-number">2.3.</span> <span class="nav-text">WordPiece</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Unigram-Language-Model"><span class="nav-number">2.4.</span> <span class="nav-text">Unigram Language Model</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pointer-Generator-Network"><span class="nav-number">3.</span> <span class="nav-text">Pointer-Generator Network</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Baseline-sequence-to-sequence"><span class="nav-number">3.1.</span> <span class="nav-text">Baseline sequence-to-sequence</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pointer-Generator-Network-1"><span class="nav-number">3.2.</span> <span class="nav-text">Pointer-Generator-Network</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Coverage-mechanism"><span class="nav-number">3.3.</span> <span class="nav-text">Coverage mechanism</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Word-Repetition"><span class="nav-number">4.</span> <span class="nav-text">Word Repetition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Text-Summarization-%E5%9C%A8%E9%98%BF%E2%BE%A5"><span class="nav-number">5.</span> <span class="nav-text">Text Summarization 在阿⾥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hyper-Parameter-Tuning"><span class="nav-number">6.</span> <span class="nav-text">Hyper-Parameter Tuning</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Hand-Turning"><span class="nav-number">6.1.</span> <span class="nav-text">Hand Turning</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Good-Coding-Style"><span class="nav-number">6.1.1.</span> <span class="nav-text">Good Coding Style</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#General-to-Specific"><span class="nav-number">6.1.2.</span> <span class="nav-text">General to Specific</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Speed-up-Experiment"><span class="nav-number">6.1.3.</span> <span class="nav-text">Speed up Experiment</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Experiment-Number"><span class="nav-number">6.1.4.</span> <span class="nav-text">Experiment Number</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HP-Range"><span class="nav-number">6.1.5.</span> <span class="nav-text">HP Range</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Auto-Turning"><span class="nav-number">6.2.</span> <span class="nav-text">Auto Turning</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="进军要努力呀"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">进军要努力呀</p>
  <div class="site-description" itemprop="description">可怕的是自己内心的堕落</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/marchboy" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;marchboy" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jjgdut@gmail.com" title="E-Mail → mailto:jjgdut@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/yourname" title="Google → https:&#x2F;&#x2F;plus.google.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i>Google</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://youtube.com/yourname" title="YouTube → https:&#x2F;&#x2F;youtube.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/pinard" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;pinard" rel="noopener" target="_blank">刘建平Pinard</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://vel.life/" title="https:&#x2F;&#x2F;vel.life&#x2F;" rel="noopener" target="_blank">思维之海</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://wulc.me/" title="https:&#x2F;&#x2F;wulc.me&#x2F;" rel="noopener" target="_blank">吴良超的学习笔记</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/IT_job" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;IT_job" rel="noopener" target="_blank">IT_job的博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.zdaiot.com/categories/" title="https:&#x2F;&#x2F;www.zdaiot.com&#x2F;categories&#x2F;" rel="noopener" target="_blank">zdaiot</a>
        </li>
    </ul>
  </div>


      </div>
	 <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1858139145&auto=1&height=66"></iframe>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">进军要努力呀</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">182k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">2:45</span>
</div><!-- ����ҳ�ײ�������վ����ʱ�� -->
<span id="timeDate">��������...</span><span id="times">����ʱ����...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("09/01/2020 00:00:00");//�˴��޸���Ľ�վʱ�������վ����ʱ��
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "Run for "+dnum+" Days ";
        document.getElementById("times").innerHTML = hnum + " Hours " + mnum + " m " + snum + " s";
    }
setInterval("createtime()",250);
</script>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '9de70fca612487225ccc',
      clientSecret: 'c5242111211342b5c4846f7f261816d1940d3996',
      repo        : 'marchboy.github.io',
      owner       : 'marchboy',
      admin       : ['marchboy'],
      id          : '5bce18595ebdfc3bc30e0303de4730ad',
        language: '',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'qAoqMWohGTiECb1RgaNqvgNB-MdYXbMMI',
      appKey     : 'ISI8QFSo7GcRyExPHSjMkz7R',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
